var systemx=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);class o extends Error{constructor(e){super(e),this.name=this.constructor.name}}t.FileNotFoundError=o;class s{constructor(){this.onChangeListeners=[]}onChange(){console.log("CHANGE FUNC",this,this.name,this.onChangeListeners);for(let e of this.onChangeListeners)e(this)}addOnChangeListener(e){console.log("ADD",this,this.name,e),this.onChangeListeners.push(e)}get directory(){return!1}readText(e){return r(this,void 0,void 0,function*(){let t=yield this.read(e);return i.parseTextArrayBuffer(t)})}readJSON(e){return r(this,void 0,void 0,function*(){let t=yield this.read(e);return i.parseJsonArrayBuffer(t)})}copy(e){return r(this,void 0,void 0,function*(){yield e.write(yield this.read())})}move(e){return r(this,void 0,void 0,function*(){yield this.copy(e),yield this.delete()})}toString(){return this.name}}t.BasicFile=s;class a extends s{static get mimeType(){return"application/json"}get mimeType(){return a.mimeType}get size(){return 0}get url(){return null}read(e){return r(this,void 0,void 0,function*(){let e=[],t=yield this.getChildren();for(let n of t)e.push({id:n.id,name:n.name,directory:n.directory,url:n.url,icon:n.icon,size:n.size,mimeType:n.mimeType,lastModified:n.lastModified.toISOString(),created:n.created.toISOString(),extra:n.extra});let n=JSON.stringify(e);return i.stringToArrayBuffer(n)})}write(e){return r(this,void 0,void 0,function*(){throw new Error("Cannot write to a directory.")})}getFile(e){return r(this,void 0,void 0,function*(){if(0===e.length)return this;let t,n,r=e[e.length-1],i=e.slice(0,e.length-1),s=yield this.getFile(i);if(!(s instanceof a))throw new o(`File ${r} not found.`);for(t=yield s.getChildren();void 0===n;){let e=t.pop();if(void 0===e)throw new o(`File ${r} not found.`);e.name===r&&(n=e)}return n})}}t.Directory=a},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});let n=["KB","MB","GB","TB"];function r(t){if(void 0!==e)return e.from(t).toString();if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(new Uint8Array(t));{let e=new Uint8Array(t);return String.fromCharCode.apply(null,e)}}t.convertBytesToReadable=function(e){let t=null,r=n.length;for(;!t&&r>0;){let i=e/Math.pow(10,3*r),o=i>10?0:1;if(i>1||0===r){let e=n[r-1];t=`${i.toFixed(o)} ${e}`}r--}return t||`${e} bytes`},t.compareStrings=function(e,t){return e.localeCompare(t)},t.compareNumbers=function(e,t){return e-t},t.compareDateStrings=function(e,t){return new Date(e).getTime()-new Date(t).getTime()},t.parseTextArrayBuffer=r,t.parseJsonArrayBuffer=function(e){let t=r(e);return JSON.parse(t)},t.arrayBufferToDataUrl=function(e,t){let n="",r=new Uint8Array(e);for(let e of r)n+=String.fromCharCode(e);return`data:${t};base64,${btoa(n)}`},t.fileToArrayBuffer=function(e){return new Promise((t,n)=>{let r=new FileReader;r.onload=(()=>{let i=r.result;i instanceof ArrayBuffer?t(i):n("Could not read file "+e)}),r.onerror=(()=>{n(r.error)}),r.readAsArrayBuffer(e)})},t.stringToArrayBuffer=function(e){return Uint8Array.from([...e].map(e=>e.charCodeAt(0))).buffer},t.copyArrayBuffer=function(e){let t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t},t.getOpt=function(...e){let t=0,n={};for(;t<e.length;){if(e[t].startsWith("-")){let r=e.splice(t,2);n[r[0].substr(1)]=r[1]||""}t++}return[e,n]},t.createNode=function(e){let t=document.createElement("template");t.innerHTML=e;let n=t.content.firstChild;if(n instanceof Element)return n;throw Error("string could not be converted to HTML element")}}).call(this,n(12).Buffer)},function(e,t,n){"use strict";n.r(t),n.d(t,"CustomElement",function(){return r});class r extends HTMLElement{constructor(){super(),this.connected=!1,null===this.shadowRoot&&this.attachShadow({mode:"open"})}static get observedAttributes(){return[]}get css(){return null}get template(){return null}connectedCallback(){this.connected=!0,this.refresh()}disconnectedCallback(){this.connected=!1}attributeChangedCallback(e,t,n){this.connected&&this.refresh()}removeShadowChildren(){if(this.shadowRoot)for(;this.shadowRoot.firstChild;)this.shadowRoot.removeChild(this.shadowRoot.firstChild)}removeChildren(e){if(void 0!==e){let t=Array.from(this.children);for(let n of t)n instanceof e&&this.removeChild(n)}else for(;this.firstChild;)this.removeChild(this.firstChild)}appendShadowChild(e){this.shadowRoot&&this.shadowRoot.appendChild(e)}appendShadowChildren(e){if(this.shadowRoot){let t=document.createDocumentFragment();for(let n of e)t.appendChild(n);this.shadowRoot.appendChild(t)}}appendChildren(e){let t=document.createDocumentFragment();for(let n of e)t.appendChild(n);this.appendChild(t)}flatChildren(e){return function t(n){let r=[];for(let i of n.children)(void 0===e||i instanceof e)&&r.push(i),r=r.concat(t(i));return r}(this)}refresh(){this.removeShadowChildren();let e={};for(let t of this.constructor.observedAttributes)e[t]=this.getAttribute(t);this.updateAttributes(e),this.shadowRoot&&this.render(this.shadowRoot)}render(e){let t=this.css;if(t){let n=document.createElement("style");n.type="text/css",n.innerHTML=t.toString(),e.appendChild(n)}let n=this.template;if(n){if(!(n instanceof HTMLTemplateElement)){let e=document.createElement("template");e.innerHTML=n.toString(),n=e}let t=document.importNode(n.content,!0);e.appendChild(t)}}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(0));let s=0;class a extends o.BasicFile{constructor(e,t,n,r){super(),this.created=new Date,this.icon=null,this.extra={},this.parent=e,this.name=t,this.mimeType=n||"application/octet-stream",this.fileData=r||new ArrayBuffer(0),this.lastModified=new Date,s++,this.id=s.toString()}get url(){let e=new Uint8Array(this.fileData),t=String.fromCharCode.apply(null,e);return`data:${this.mimeType};base64,${btoa(t)}`}get size(){return this.fileData.byteLength}read(e){return r(this,void 0,void 0,function*(){return this.fileData})}write(e){return r(this,void 0,void 0,function*(){return this.fileData=e,this.lastModified=new Date,e})}delete(){return r(this,void 0,void 0,function*(){this.parent.removeChild(this)})}rename(e){return r(this,void 0,void 0,function*(){this.name=e,this.lastModified=new Date})}}t.MemoryFile=a;class l extends o.Directory{constructor(e,t){super(),this.created=new Date,this.icon=null,this.extra={},this.children=[],this.parent=e,this.name=t,s++,this.id=s.toString()}get lastModified(){return 0===Object.values(this.children).length?this.created:new Date(Math.max.apply(null,Object.values(this.children).map(function(e){return new Date(e.lastModified).getTime()})))}delete(){return r(this,void 0,void 0,function*(){null!==this.parent&&this.parent.removeChild(this)})}rename(e){return r(this,void 0,void 0,function*(){this.name=e})}getChildren(){return r(this,void 0,void 0,function*(){return this.children.slice()})}search(e){return r(this,void 0,void 0,function*(){let t=[];for(let n of this.children)if(name===e&&t.push(n),n instanceof o.Directory){let r=yield n.search(e);t=t.concat(r)}return t})}addFile(e,t,n){return r(this,void 0,void 0,function*(){let r=new a(this,t,n,e);return this.addChild(r),r})}addDirectory(e){return r(this,void 0,void 0,function*(){let t=new l(this,e);return this.addChild(t),t})}addChild(e){this.children.push(e)}removeChild(e){this.children=this.children.filter(t=>t!==e)}}t.MemoryDirectory=l},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);let o=0,s=[];t.ProcessFile=class extends i.BasicFile{constructor(){super(),this._created=new Date,this._lastModified=new Date,this.extra={},o++,this._id=o,console.log("PUSH",this),s.push(this)}get id(){return this._id.toString()}get url(){return null}get icon(){return null}get size(){return 0}get mimeType(){return"text/plain"}get created(){return this._created}get lastModified(){return this._lastModified}delete(){return r(this,void 0,void 0,function*(){console.log("DELETE"),console.trace(),s=s.filter(e=>e!==this)})}};t.ProcessDirectory=class extends i.Directory{constructor(){super(...arguments),this._created=new Date,this._lastModified=new Date}get id(){return"proc"}get name(){return"proc"}get url(){return null}get icon(){return null}get created(){return this._created}get lastModified(){return this._lastModified}getChildren(){return r(this,void 0,void 0,function*(){return console.log("PROC CHILD",s.slice()),s.slice()})}}},function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(2);class i extends r.CustomElement{constructor(){super(),this._position={x:0,y:0},this._velocity={x:0,y:0},this.motionTimeout=null,this.lastPositionUpdateTime=null,this.frictionCoef=100,this.timeStep=.01}updateAttributes(e){}connectedCallback(){super.connectedCallback(),this.style.position="absolute",this.lastPositionUpdateTime=null,this.position={x:0,y:0}}get position(){return Object.assign({},this._position)}set position(e){let t=this._position;this._position={x:e.x||0,y:e.y||0},this.style.left=`${Math.round(this._position.x).toString()}px`,this.style.top=`${Math.round(this._position.y).toString()}px`;let n=(new Date).getTime();if(null!==this.lastPositionUpdateTime){let e=(n-this.lastPositionUpdateTime)/1e3;this.velocity={x:(this._position.x-t.x)/e,y:(this._position.y-t.y)/e}}this.lastPositionUpdateTime=n}get frictionForce(){let e=this.velocity,t=Math.sign(e.x)||0,n=Math.sign(e.y)||0;return{x:-1*t*this.frictionCoef,y:-1*n*this.frictionCoef}}get velocity(){return this._velocity||{x:0,y:0}}set velocity(e){this.motionTimeout&&clearTimeout(this.motionTimeout),this.motionTimeout=null;let t=e.x,n=e.y;if(this._velocity={x:t,y:n},t>0||n>0)if(this.speed<10)this.velocity={x:0,y:0};else{const e=this.timeStep;this.motionTimeout=window.setTimeout(()=>{let r=this.position;this.position={x:r.x+t*e,y:r.y+n*e};let i=this.frictionForce,o=t+i.x*e,s=n+i.y*e;Math.sign(o)!==Math.sign(t)&&(o=0),Math.sign(s)!==Math.sign(n)&&(s=0),this.velocity={x:o,y:s}},1e3*e)}}get speed(){let e=this.velocity;return Math.sqrt(e.x*e.x+e.y*e.y)}center(){let e=this.getBoundingClientRect(),t=window.innerWidth/2-e.width/2,n=window.innerHeight/2-e.height/2;this.position={x:t,y:n},this.velocity={x:0,y:0}}}class o extends i{constructor(){super(),this.startPosition={x:0,y:0},this.mouseStartPosition={x:0,y:0},this.includeChildren=!1,this.noPropagate=!1,this.onmousedown=(e=>{this.noPropagate&&e.stopImmediatePropagation(),(e.target===this||this.includeChildren)&&(e.preventDefault(),this.startPosition=this.position,this.mouseStartPosition={x:e.clientX,y:e.clientY},this.startDrag())})}startDrag(){document.onmousemove=(e=>{e.preventDefault(),this.noPropagate&&e.stopImmediatePropagation();let t=e.clientX-this.mouseStartPosition.x,n=e.clientY-this.mouseStartPosition.y;this.position={x:this.startPosition.x+t,y:this.startPosition.y+n},this.velocity={x:0,y:0}}),document.onmouseup=this.stopDrag.bind(this)}stopDrag(e){this.noPropagate&&e.stopImmediatePropagation(),e.preventDefault(),document.onmousemove=null,document.onmouseup=null}}class s extends i{constructor(){super(),this.touchStartPosition={},this.scrollSpeed=s.defaultScrollSpeed,this.onwheel=(e=>{let t=this.position;t.y-=e.deltaY*this.scrollSpeed,this.position=t}),this.ontouchstart=(e=>{for(let t of e.targetTouches)this.touchStartPosition[t.identifier]={coords:{x:t.clientX,y:t.clientY},elementPosition:this.position}}),this.ontouchmove=(e=>{for(let t of e.targetTouches){let e=this.touchStartPosition[t.identifier];if(e){let n=t.clientX-e.coords.x,r=t.clientY-e.coords.y;this.position={x:e.elementPosition.x+n,y:e.elementPosition.y+r}}}}),this.ontouchend=(e=>{for(let t of e.targetTouches)delete this.touchStartPosition[t.identifier]})}static get observedAttributes(){return["scroll-speed"]}updateAttributes(e){let t=e["scroll-speed"];this.scrollSpeed=null===t?s.defaultScrollSpeed:Number.parseFloat(t)}}s.defaultScrollSpeed=1},function(e,t,n){"use strict";n.r(t),n.d(t,"Dialog",function(){return i}),n.d(t,"ConfirmDialog",function(){return o});var r=n(5);class i extends r.a{constructor(){super(),this.deleteButtonClass="delete",this.expandButtonClass="expand",this.nameClass="name",this.headerClass="header",this.containerClass="container",this.noPropagate=!0,this.onShow=null,this.onClose=null,this.onRemove=null,this.nameElement=document.createElement("span"),this.nameElement.className=this.nameClass,this.headerElement=document.createElement("div"),this.headerElement.className=this.headerClass,this.containerElement=document.createElement("div"),this.containerElement.className=this.containerClass;let e=document.createElement("button");e.type="button",e.className=this.expandButtonClass,e.onmousedown=(e=>{e.stopPropagation(),e.preventDefault()}),e.onclick=(e=>{e.stopPropagation(),e.preventDefault(),this.expanded=!0});let t=document.createElement("button");t.type="button",t.className=this.deleteButtonClass,t.onmousedown=(e=>{e.stopPropagation(),e.preventDefault()}),t.onclick=(e=>{e.stopPropagation(),e.preventDefault(),this.visible=!1}),this.headerElement.appendChild(this.nameElement),this.headerElement.appendChild(t),this.headerElement.appendChild(e);let n=document.createElement("slot");this.containerElement.appendChild(n),this.documentClickListener=(e=>{this.closeOnOutsideClick(e)})}static get observedAttributes(){return["name","visible","expanded"]}get css(){return`     \n      :host {\n        --dialog-font: 'Open Sans', sans-serif;\n        --dialog-background: #ecf2f6;\n        --dialog-shadow: 2px 2px 0 0 #444;\n        --dialog-header-height: 28px;\n        --dialog-header-text-color: black;\n        --dialog-header-background-color: #c0d5e8;\n        --dialog-item-text-color: #5c6873;\n        --button-color: white;\n        --button-hover-color: #999;\n        --button-height: 30px;\n        --button-min-width: 50px;\n        --delete-button: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gMUEDkZeUosOwAAAtJJREFUWMPNmL9PFEEUxz+7IfzQkHCGQlBC7uzuYiWUlIaWno20a71/x9ROCxl7WmJ5JViZozwERCyIZ0ICQsFa+Nasm52ZvRXO+yab7CVv5r47853ve28CKiCKE4xW2fsrYA1YBzrAUiH8FOgBe0DXaPWxOIcLQRUiUZw8AjaA99TDW2DbaHXtIxZUIPMG2OZ+sGW02nGRCjxk9oEV7hcHRqtVGykboQZwDkzxMLgBFoxWAyehKE4AGsB3RoMF4Ft+pcKSk3TO6PBZpPE3oYJmpkZIaCqKk/08qSC3Qq7TlEpsB/gALFb8w6/Aa/Gl1HGqt4xWOwCBMJsBrhxkboG20aofxUkAHAHLHjLHQNNolUZx0gIOgUkHqcfAVSi62fKYZxvo5wi2gIFjzEBiUvndlzlcRrxhtPodEMVJ6gjsGK0OS6xhBvghX53HLTBntLouGdOW7SuF0SoIJDcdeHTwHEiLRiakzsQqspV5ViQjsgiALx79rYSSKF1YFM2EJV90DcyLXo6B+bKVkbFHFQ7DWihZ24dl4EJWpIg74KU8d5atvahwCADWgyhOTkpKCBus+rCkIJvObDgNPIK2naB54M6WsUUzoaxMY5jJwxru2pBjPOuImZWYxrCT1yH0oKhDKDO9S0fMZQXzLHfhcRP1hDjnUsWVsZlepqfLvNClhp4rmKcLvVC6Ax98pvdJHp95+rAXAt0KJUSzgun5zLMpc7nQHbvkOiHvm46eqxfFyQugn6vsQtFFmVgngbMoTv6Yp4xpuchI70YowbuOwFSKq1auPvKZXmaeWf2TFWiundiO4mT8Sth8kb/jqIuyiXpDkMlKl56nSz7IutlikZ91Hj9H2HncGK2m811sWaP4dIS92RNgkDfTsWulbcl1YLSa9tTa/3LZMG1LvKHFoDJNrXpapDrXMatDX8eUCH1GiL2rSWQT2DVaXdW+sPpfV3q/AM0PYtQhZQVnAAAAAElFTkSuQmCC);\n        --expand-button: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gYHEhUdzt4g4wAAAlJJREFUWMPtmLFr20AUxn+6Oq7imoQUCs2QvyCDh9TQJVshayBbY+rVhUIH/xnlhnbJrTGXbKVdM3XwEmgyZAhkLHhIoVDToXbT0KbLU1CPk6zIqqOhHwgZcXr+9O5J7/teQAa0Ol2s0dHvNWAd2ABWgRVn+QA4BQ6AvjX62I2RhiALkVanWwM2gT3y4Tmwa40eTyIWZCDzDNilGLSt0b00UsEEMh+BRxSLI2t0M4lUEqEl4By4y7/BBbBsjR6mEmp1ugBLwFdmg2XgczxTyvMmnTM7fJLS+DtDE2rmDPgAhMDClAQWgQbwIKmmgliGfG/TGbAl5wC4MyWhqsR75ZBqW6N7AIGkax4YeQLsAC+A3wVuUx14Bzxxrt8DRkrqpp1wc+gU/pw85U2PuViMn8A3z39tWqOpxDLhw4Js0y+gArwEHufIyiHwGrhMWbMH7FekN2WBEjJbObfqTYaeuaakUZYF60q6dlmwoURClAWryqNnbhMripLhP6EshAYl4jNQIsjLglMl7qAsOFBAv0SE+iryTWWANfo46vbbGTzXlXTtPDiU+yd5t2uBVgO+exa9BZ6Khon0UJCD0FVMelSBfY9qqAHjigi0UavTbXsk7KIEiAhdFrAzVYnrGsjx9YdRBHYPOHIWNuRJ6jmVonvUJV7DEfm9yHkEHrf6wzGIX4CTBNk5reu4sEaHcRfrM4oPZ+jN7gPDuFEsnZVOaq5Da3Toqamihg0hMMzc7SN7a41uplikvOOY5o3HMZ5CnxdiOzmJbAPvrdGj3AOr2xrp/QFWN+Jth0cnawAAAABJRU5ErkJggg==);\n      \n        display: none;\n        background: var(--dialog-background);\n        box-shadow: var(--dialog-shadow);\n        z-index: 10;\n        font-family: var(--dialog-font);\n        font-weight: bold;\n        border: 1px solid black;\n      }\n      \n      :host([visible]) {\n        display: block;\n      }\n    \n      :host([expanded]) {\n        width: 100%;\n        height: 100%;\n      }\n      \n      .${this.headerClass} {\n        display: flex;\n        box-sizing: border-box;\n        height: var(--dialog-header-height);\n        padding-left: 4px;\n        background-color: var(--dialog-header-background-color);\n        color: var(--dialog-header-text-color);\n        white-space: nowrap;\n        cursor: move;\n      }\n      \n      .${this.nameClass} {\n        flex: 1;\n        line-height: var(--dialog-header-height);\n        margin-left: 4px;\n        margin-right: 4px;\n        font-size: 14px;\n      }\n      \n      .${this.headerClass} > button {\n        border: none;\n        background-color: inherit;\n        padding: unset;\n        width: var(--dialog-header-height);\n        height: var(--dialog-header-height);\n      }\n      \n      button {\n        display: inline-block;\n        float: right;\n        width: 18px;\n        height: 18px;\n        cursor: pointer;\n      }\n      \n      .${this.expandButtonClass}::after {\n        display: inline-block;\n        width: 100%;\n        height: 100%;\n        background-size: 18px 18px;\n        background-image: var(--expand-button);\n        background-repeat: no-repeat;\n        background-position: center;\n        content: "";\n      }\n      \n      .${this.deleteButtonClass}::after {\n        display: inline-block;\n        width: 100%;\n        height: 100%;\n        background-size: 18px 18px;\n        background-image: var(--delete-button);\n        background-repeat: no-repeat;\n        background-position: center;\n        content: "";\n      }\n    `}get name(){return this.nameElement.innerText}set name(e){this.nameElement.innerText=e}get visible(){return!(null===this.getAttribute("visible"))}set visible(e){if(e!==this.visible)if(e){this.setAttribute("visible","true");let e=new Event(i.EVENT_OPENED);this.dispatchEvent(e)}else{this.removeAttribute("visible");let e=new Event(i.EVENT_CLOSED);this.dispatchEvent(e)}}get expanded(){return!(null===this.getAttribute("expanded"))}set expanded(e){e!==this.expanded&&(e?(this.setAttribute("expanded","true"),this.position={x:0,y:0}):this.removeAttribute("expanded"))}updateAttributes(e){this.visible=!(null===e.visible),this.expanded=!(null===e.expanded),null===e.name?this.name="":this.name=e.name}connectedCallback(){super.connectedCallback(),this.style.position="fixed",document.addEventListener("click",this.documentClickListener)}disconnectedCallback(){document.removeEventListener("click",this.documentClickListener)}render(e){super.render(e),e.appendChild(this.headerElement),e.appendChild(this.containerElement)}remove(){this.onRemove&&this.onRemove(this),this.parentElement&&this.parentElement.removeChild(this),document.removeEventListener("click",this.documentClickListener)}closeOnOutsideClick(e){if(!e.defaultPrevented){let t=new Set,n=e.target;for(;n;)t.add(n),n=n.parentElement;let r=t.has(this),o=!1;for(let e of this.flatChildren(i))t.has(e)&&(o=!0);r||o||(this.visible=!1)}}}i.EVENT_OPENED="opened",i.EVENT_CLOSED="closed";class o extends i{constructor(){super(),this._confirmButton=document.createElement("button")}render(e){super.render(e),this._confirmButton.innerText="Yes",this._confirmButton.onclick=this.onConfirmed.bind(this),this._confirmButton.className="button",e.appendChild(this._confirmButton)}set confirmationText(e){this._confirmButton.innerText=e}set disabled(e){this._confirmButton.disabled=Boolean(e)}onConfirmed(e){e.preventDefault(),this.visible=!1;let t=new Event(o.EVENT_CONFIRMED);this.dispatchEvent(t)}}o.EVENT_CONFIRMED="confirmed",customElements.define("base-dialog",i),customElements.define("confirm-dialog",o)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(17),s=n(18),a=n(19),l=i(n(0)),c=[new o.ConsoleFile,new s.NullFile];t.DeviceDirectory=class extends l.Directory{constructor(){super(),this.created=new Date,this.lastModified=new Date,this.extra={},this.extraChildren=[],this.extraChildren=[];for(let e of document.querySelectorAll(".device"))this.extraChildren.push(new a.DomElementDevice(e))}get name(){return"dev"}get id(){return"dev"}get icon(){return null}getChildren(){return r(this,void 0,void 0,function*(){return c.slice().concat(this.extraChildren)})}addDirectory(e){return r(this,void 0,void 0,function*(){throw new Error("can't add directory to device directory")})}addFile(e,t,n){return r(this,void 0,void 0,function*(){throw new Error("can't add file to device directory")})}delete(){return r(this,void 0,void 0,function*(){throw new Error("can't delete device directory")})}rename(e){return r(this,void 0,void 0,function*(){throw new Error("can't rename device directory")})}search(e){return r(this,void 0,void 0,function*(){return[]})}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(9),s=i(n(0));class a extends o.ProxyDirectory{constructor(e,t){super(e),this.mounts=t||{}}getChildren(){const e=Object.create(null,{getChildren:{get:()=>super.getChildren}});return r(this,void 0,void 0,function*(){let t=yield e.getChildren.call(this),n=[];for(let e of t){let t=this.mounts[e.id];void 0!==t?n.push(new a(t)):e instanceof s.Directory?n.push(new a(e,this.mounts)):n.push(e)}return n})}addDirectory(e){const t=Object.create(null,{addDirectory:{get:()=>super.addDirectory}});return r(this,void 0,void 0,function*(){let n=yield t.addDirectory.call(this,e);return new a(n,this.mounts)})}mount(e){this.mounts[this.id]=e}}t.VirtualDirectory=a},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(0));class s extends o.BasicFile{constructor(e){super(),this.concreteFile=e}get id(){return this.concreteFile.id}get name(){return this.concreteFile.name}get directory(){return this.concreteFile.directory}get url(){return this.concreteFile.url}get icon(){return this.concreteFile.icon}get size(){return this.concreteFile.size}get mimeType(){return this.concreteFile.mimeType}get lastModified(){return this.concreteFile.lastModified}get created(){return this.concreteFile.created}get extra(){return this.concreteFile.extra}addOnChangeListener(e){this.concreteFile.addOnChangeListener(e)}read(e){return this.concreteFile.read(e)}write(e){return this.concreteFile.write(e)}rename(e){return this.concreteFile.rename(e)}delete(){return this.concreteFile.delete()}}t.ProxyFile=s;class a extends o.Directory{constructor(e){super(),this.concreteDirectory=e}get id(){return this.concreteDirectory.id}get name(){return this.concreteDirectory.name}get directory(){return this.concreteDirectory.directory}get url(){return this.concreteDirectory.url}get icon(){return this.concreteDirectory.icon}get lastModified(){return this.concreteDirectory.lastModified}get created(){return this.concreteDirectory.created}get extra(){return this.concreteDirectory.extra}onChange(){this.concreteDirectory.onChange()}addOnChangeListener(e){this.concreteDirectory.addOnChangeListener(e)}rename(e){return this.concreteDirectory.rename(e)}delete(){return this.concreteDirectory.delete()}search(e){return this.concreteDirectory.search(e)}addFile(e,t,n){return this.concreteDirectory.addFile(e,t,n)}addDirectory(e){return this.concreteDirectory.addDirectory(e)}getChildren(){return this.concreteDirectory.getChildren()}}t.ProxyDirectory=a;class l extends s{write(e){const t=Object.create(null,{write:{get:()=>super.write}});return r(this,void 0,void 0,function*(){let n=yield t.write.call(this,e);return this.onChange(),n})}rename(e){const t=Object.create(null,{rename:{get:()=>super.rename}});return r(this,void 0,void 0,function*(){let n=yield t.rename.call(this,e);return this.onChange(),n})}delete(){const e=Object.create(null,{delete:{get:()=>super.delete}});return r(this,void 0,void 0,function*(){yield e.delete.call(this),this.onChange()})}}t.ChangeEventProxyFile=l;class c extends a{rename(e){const t=Object.create(null,{rename:{get:()=>super.rename}});return r(this,void 0,void 0,function*(){let n=yield t.rename.call(this,e);return this.onChange(),n})}delete(){const e=Object.create(null,{delete:{get:()=>super.delete}});return r(this,void 0,void 0,function*(){yield e.delete.call(this),this.onChange()})}addFile(e,t,n){const i=Object.create(null,{addFile:{get:()=>super.addFile}});return r(this,void 0,void 0,function*(){let r=i.addFile.call(this,e,t,n);return this.onChange(),r})}addDirectory(e){const t=Object.create(null,{addDirectory:{get:()=>super.addDirectory}});return r(this,void 0,void 0,function*(){console.log("ADD DIR",e);let n=t.addDirectory.call(this,e);return this.onChange(),n})}getChildren(){const e=Object.create(null,{getChildren:{get:()=>super.getChildren}});return r(this,void 0,void 0,function*(){let t=[];for(let n of yield e.getChildren.call(this))(n=n instanceof o.Directory?new c(n):new l(n)).addOnChangeListener(()=>{this.onChange()}),t.push(n);return t})}}t.ChangeEventProxyDirectory=c;class h extends c{constructor(e,t){super(e),this.cachedChildren=null,this.parent=t||null}get root(){return null===this.parent?this:this.parent.root}get path(){return null===this.parent?[this]:this.parent.path.concat([this])}getChildren(){const e=Object.create(null,{getChildren:{get:()=>super.getChildren}});return r(this,void 0,void 0,function*(){if(null===this.cachedChildren){this.cachedChildren=[];for(let t of yield e.getChildren.call(this))t instanceof o.Directory&&(t=new h(t,this)),this.cachedChildren.push(t)}return this.cachedChildren.slice()})}clearCache(){this.cachedChildren=null}}t.CachedProxyDirectory=h},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),o=n(1),s=Object.getPrototypeOf(function(){return r(this,void 0,void 0,function*(){})}).constructor,a='\n    // wrap onmessage setup in function so that variables created (id, calls, etc.)\n    // aren\'t in worker script scope.\n    onmessage = function () {\n        const AsyncFunction = Object.getPrototypeOf(async function(){}).constructor;\n    \n        let id = 0;\n        const calls = {};\n    \n        const system = new Proxy({}, {\n            get: function (obj, sysCallName) {\n                // Make a system call "prop"\n                return (...args) => {\n                    return new Promise((resolve, reject) => {\n                        id ++;\n                        calls[id] = resolve;\n                        postMessage([id, sysCallName].concat(args));\n                    });\n                }\n            }\n        });\n        \n        function initialize(e) {\n            let func = new AsyncFunction(\'system\', e.data);\n            func.bind(this)(system)\n                .then(() => {\n                    return system.exit("");\n                }).catch((error) => {\n                system.error(error.toString());\n                console.log(error);\n            });\n            messageHandler = handleCallReturn;\n        }\n        \n        function handleCallReturn(e) {\n            let id = e.data[0];\n            let data = e.data[1];\n            let sysCall = calls[id];\n            if (sysCall){\n                delete calls[id];\n                sysCall(data);\n            }\n        }\n        \n        let messageHandler = initialize;\n    \n    \n        return messageHandler;\n    }();\n';let l=0;class c extends i.ProcessFile{constructor(e,t,n,r,i){super(),this.fileDescriptors={},console.log("START"),this.parentProcess=e,this.workingDirectory=t,this.executablePath=n,this.executableName=n[n.length-1],this.stdin=this,this.stdout=r,this.stderr=i,this.worker=new Worker("data:application/javascript,"+encodeURIComponent(a)),this.worker.onmessage=(e=>{let t=e.data[0],n=e.data[1],r=e.data.slice(2);console.log("WORKER CALL",n);let i=this.systemCalls[n];i?i(...r).then(e=>{this.worker.postMessage([t,e])}).catch(e=>{let t=o.stringToArrayBuffer(`System error: ${e}`);return this.onExit(),this.stderr.write(t)}):console.log(`Invalid operation ${n}`)}),this.workingDirectory.getFile(this.executablePath).then(e=>e.readText()).then(e=>this.worker.postMessage(e)).catch(e=>{let t=o.stringToArrayBuffer(`File ${this.executableName} could not be executed: ${e}`);return this.onExit(),this.stderr.write(t)})}get name(){return this.executableName}fork(){return new c(this,this.workingDirectory,[this.executableName],this.stdout,this.stderr)}get systemCalls(){let e=e=>{let t=this.fileDescriptors[e];if(void 0===t)throw new Error("File is not open.");return t};return{import:(e,t)=>r(this,void 0,void 0,function*(){let n=yield(yield this.workingDirectory.getFile(e)).readText();try{return yield new s(`${n};return ${t};`).bind(this)()}catch(t){throw new Error(`Error importing file at ${e.join("/")}: ${t}`)}}),open:e=>r(this,void 0,void 0,function*(){let t=yield this.workingDirectory.getFile(e);return l++,this.fileDescriptors[l]=t,l}),close:e=>r(this,void 0,void 0,function*(){delete this.fileDescriptors[e]}),read:t=>r(this,void 0,void 0,function*(){return yield e(t).read()}),write:(t,n)=>r(this,void 0,void 0,function*(){return yield e(t).write(n)}),fork:()=>r(this,void 0,void 0,function*(){let e=new c(this,this.workingDirectory,[this.executableName],this.stdout,this.stderr);return Number.parseInt(e.id)}),exec:(e,...t)=>r(this,void 0,void 0,function*(){let t=new c(this,this.workingDirectory,e,this.stdout,this.stderr);return Number.parseInt(t.id)}),exit:e=>r(this,void 0,void 0,function*(){let t=o.stringToArrayBuffer(e);yield this.stdout.write(t),this.onExit()}),error:e=>r(this,void 0,void 0,function*(){let t=o.stringToArrayBuffer(`The process ${this.name} returned an error: ${e}`);yield this.stderr.write(t),this.onExit()})}}execPath(e,...t){return r(this,void 0,void 0,function*(){return new c(this,this.workingDirectory,e,this.stdout,this.stderr).id})}onExit(){this.worker.terminate(),this.delete()}}t.Process=c},function(e,t,n){"use strict";n.r(t),n.d(t,"fs",function(){return h}),n.d(t,"createFS",function(){return u});var r=n(3),i=n(10),o=n(1),s=n(4),a=n(7),l=(n(20),n(8));const c='\n  console.log("YAS");\n',h=new l.VirtualDirectory(new r.MemoryDirectory(null,"root"));async function u(){let e=new l.VirtualDirectory(new r.MemoryDirectory(null,"root"));(await e.addDirectory("dev")).mount(new a.DeviceDirectory),(await e.addDirectory("proc")).mount(new s.ProcessDirectory),await e.addFile(Object(o.stringToArrayBuffer)(c),"init.js","application/javascript");let t=await e.getFile(["dev","console"]);return new i.Process(null,e,["init.js"],t,t),e}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(14),i=n(15),o=n(16);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(h(t),e=a(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(r)return j(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,s=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var h=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var u=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){u=!1;break}if(u)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return H(j(t,e.length-n),e,n,r)}function C(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function b(e,t,n,r){return C(e,t,n,r)}function E(e,t,n,r){return H(Y(t),e,n,r)}function x(e,t,n,r){return H(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function A(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function D(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,l,c=e[i],h=null,u=c>239?4:c>223?3:c>191?2:1;if(i+u<=n)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(h=l);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(h=l)}null===h?(h=65533,u=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=u}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return h(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?D(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return D(this,t,n);case"ascii":return _(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,a=Math.min(o,s),c=this.slice(r,i),h=e.slice(t,n),u=0;u<a;++u)if(c[u]!==h[u]){o=c[u],s=h[u];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return C(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function _(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=U(e[o]);return i}function S(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function L(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function R(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function k(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||k(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,o){return o||k(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||B(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||B(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);B(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);B(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=l.isBuffer(e)?e:j(new l(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var I=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Y(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(I,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(13))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=c(e),r=n[0],s=n[1],a=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),l=0,h=s>0?r-4:r,u=0;u<h;u+=4)t=i[e.charCodeAt(u)]<<18|i[e.charCodeAt(u+1)]<<12|i[e.charCodeAt(u+2)]<<6|i[e.charCodeAt(u+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=255&t;2===s&&(t=i[e.charCodeAt(u)]<<2|i[e.charCodeAt(u+1)]>>4,a[l++]=255&t);1===s&&(t=i[e.charCodeAt(u)]<<10|i[e.charCodeAt(u+1)]<<4|i[e.charCodeAt(u+2)]>>2,a[l++]=t>>8&255,a[l++]=255&t);return a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(u(e,s,s+16383>a?a:s+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function u(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(h(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,c=l>>1,h=-7,u=n?i-1:0,d=n?-1:1,f=e[t+u];for(u+=d,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+e[t+u],u+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+e[t+u],u+=d,h-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=c}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,l,c=8*o-i-1,h=(1<<c)-1,u=h>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=h?(a=0,s=h):s+u>=1?(a=(t*l-1)*Math.pow(2,i),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),s=i(n(0));t.ConsoleFile=class extends s.BasicFile{constructor(){super(),this.created=new Date,this.lastModified=new Date,this.extra={}}get id(){return"console"}get name(){return"console"}get icon(){return null}get url(){return null}get mimeType(){return"text/plain"}get size(){return 0}read(e){return r(this,void 0,void 0,function*(){return new ArrayBuffer(0)})}write(e){return r(this,void 0,void 0,function*(){return console.log(o.parseTextArrayBuffer(e)),e})}delete(){return r(this,void 0,void 0,function*(){throw new Error("can't delete console")})}rename(e){return r(this,void 0,void 0,function*(){throw new Error("can't rename console")})}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.NullFile=class extends i.BasicFile{constructor(){super(),this.created=new Date,this.lastModified=new Date,this.extra={}}get id(){return"null"}get name(){return"null"}get icon(){return null}get url(){return null}get mimeType(){return"text/plain"}get size(){return 0}read(e){return r(this,void 0,void 0,function*(){return new ArrayBuffer(0)})}write(e){return r(this,void 0,void 0,function*(){return e})}delete(){return r(this,void 0,void 0,function*(){})}rename(e){return r(this,void 0,void 0,function*(){throw new Error("can't rename null file")})}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(0)),s=n(1);class a extends o.BasicFile{constructor(e){super(),this.created=new Date,this.extra={},this.lastModified=new Date,this.element=e}get id(){return`${this.name}-${this.element.id}`}get icon(){return null}get url(){return null}delete(){return r(this,void 0,void 0,function*(){throw new Error("can't delete element file")})}rename(e){return r(this,void 0,void 0,function*(){throw new Error("can't rename element file")})}}t.AbstractElementFile=a;class l extends a{constructor(e){super(e),this.readBuffer=[],this.element.addEventListener(this.eventName,e=>{for(console.log("EVENT",e);this.readBuffer.length>0;){let t=this.readBuffer.shift();void 0!==t&&t(e)}this.lastModified=new Date},!1)}get size(){return 0}get eventName(){return this.EVENT_NAME}getEventData(e){throw new Error("getEventData not implemented.")}read(e){return new Promise((e,t)=>{this.readBuffer.push(t=>{e(this.getEventData(t))})})}}class c extends l{constructor(){super(...arguments),this.EVENT_NAME="keydown"}get name(){return"keyboard"}get mimeType(){return"text/plain"}getEventData(e){return s.stringToArrayBuffer(e.char)}write(e){return r(this,void 0,void 0,function*(){let t=s.parseTextArrayBuffer(e);for(let e of t){let t=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:e,char:e,shiftKey:!1}),n=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,key:e,char:e,shiftKey:!1});this.element.dispatchEvent(t),this.element.dispatchEvent(n)}return e})}}class h extends l{constructor(){super(...arguments),this.EVENT_NAME="click"}get name(){return"mouse"}get mimeType(){return"application/json"}getEventData(e){let t={clientX:e.clientX||null,clientY:e.clientY||null,offsetX:e.offsetX||null,offsetY:e.offsetY||null,pageX:e.pageX||null,pageY:e.pageY||null};return s.stringToArrayBuffer(JSON.stringify(t))}write(e){return r(this,void 0,void 0,function*(){return e})}}class u extends a{constructor(e){super(e)}get name(){return"text"}get size(){return s.stringToArrayBuffer(this.element.innerText).byteLength}get mimeType(){return"text/plain"}get url(){return`data:,${encodeURIComponent(this.element.innerText)},`}read(e){return r(this,void 0,void 0,function*(){return s.stringToArrayBuffer(this.element.innerText)})}write(e){return r(this,void 0,void 0,function*(){return this.element.innerText=s.parseTextArrayBuffer(e),e})}}class d extends a{constructor(e){super(e)}get name(){return"class"}get size(){return s.stringToArrayBuffer(this.element.className).byteLength}get mimeType(){return"text/plain"}get url(){return`data:,${encodeURIComponent(this.element.className)},`}read(e){return r(this,void 0,void 0,function*(){return s.stringToArrayBuffer(this.element.className)})}write(e){return r(this,void 0,void 0,function*(){return this.element.className=s.parseTextArrayBuffer(e),e})}}class f extends o.Directory{constructor(e){super(),this.created=new Date,this.lastModified=new Date,this.extra={},""===e.id&&(e.id=`${Math.random().toString(36).substr(2,9)}`),this.element=e,this.keyboard=new c(e),this.mouse=new h(e),this.text=new u(e),this.class=new d(e)}get id(){return this.element.id}get name(){return`${this.element.tagName.toLowerCase()}-${this.id}`}get size(){return 0}get icon(){return null}addFile(e,t,n){return r(this,void 0,void 0,function*(){throw new Error("can't add file to element")})}addDirectory(e){return r(this,void 0,void 0,function*(){let t=document.createElement(e);return this.element.appendChild(t),new f(t)})}getChildren(){return r(this,void 0,void 0,function*(){let e=[this.keyboard,this.mouse,this.text,this.class];for(let t of this.element.children)t instanceof HTMLElement&&e.push(new f(t));return e})}delete(){return r(this,void 0,void 0,function*(){null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element)})}rename(e){return r(this,void 0,void 0,function*(){throw new Error("can't rename element")})}search(e){return r(this,void 0,void 0,function*(){return[]})}}t.DomElementDevice=f},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(21),s=n(0),a=n(1),l=i(n(22)),c=n(23),h=n(6),u=n(24),d=n(3),f=n(9),p=n(2);class g extends u.Row{constructor(){super(),this.file=null,this.folderIcon=a.createNode(l.folderIcon),this.folderIcon.classList.add(m.tableIconClass),this.documentIcon=a.createNode(l.documentIcon),this.documentIcon.classList.add(m.tableIconClass)}getFile(){return this.file}setFile(e){this.file=e;let t=document.createElement("table-data"),n=this.createNameColumn(),r=document.createElement("table-data"),i=document.createElement("table-data"),o=document.createElement("table-data"),s=document.createElement("table-data");this.hidden=this.file.name.startsWith("."),t.innerText=e.id,r.innerText=a.convertBytesToReadable(e.size),i.innerText=new Date(e.lastModified).toLocaleString(),o.innerText=new Date(e.created).toLocaleString(),s.innerText=e.mimeType,this.removeChildren(),this.appendChildren([t,n,r,i,o,s])}createNameColumn(){let e=document.createElement("table-data");if(null!==this.file){if(null!==this.file.icon){let t=document.createElement("img");if(t.width=22,t.height=22,t.ondragstart=(()=>!1),t.classList.add(m.tableIconClass),e.appendChild(t),this.file.directory)t.src=this.file.icon;else{t.src=this.file.icon;let n=document.createElement("img");n.className="hover-image",n.style.display="none",t.onmouseover=(e=>{null!==this.file&&null!==this.file.url&&(n.src=this.file.url),n.style.display="inline-block"}),t.onmouseout=(()=>{n.style.display="none"}),e.appendChild(n)}}else this.file instanceof s.Directory?e.appendChild(this.folderIcon):e.appendChild(this.documentIcon);let t=document.createTextNode(this.file.name);e.appendChild(t)}return e}}class m extends p.CustomElement{constructor(){super(),this.searchPending=!1,this.messageRemovalDelay=null,this.maxNumMove=30,this.cachedCurrentDirectory=new f.CachedProxyDirectory(new d.MemoryDirectory(null,"root")),this.table=document.createElement("selectable-table"),this.breadCrumbs=document.createElement("bread-crumbs"),this.dropdownMenuIcon=a.createNode(l.dropdownMenuIcon),this.dropdownMenuIcon.classList.add(m.tableIconClass),this.carrotIcon=a.createNode(l.carrotIcon),this.carrotIcon.classList.add(m.tableIconClass),this.carrotIcon.classList.add("small"),this.searchIcon=a.createNode(l.searchIcon),this.searchIcon.classList.add(m.tableIconClass),this.fileContextMenu=document.createElement("base-dialog"),this.fileContextMenu.name="Settings",this.actionsContainer=document.createElement("div"),this.actionsContainer.className=m.actionsContainerClass,this.messagesContainer=document.createElement("div"),this.messagesContainer.className=m.messageContainerClass,this.menusContainer=this.createMenus(),this.searchContainer=this.createSearchElements(),this.tableContainer=document.createElement("div"),this.tableContainer.appendChild(this.table),this.tableContainer.className=m.tableContainerClass,this.actionsContainer.appendChild(this.breadCrumbs),this.actionsContainer.appendChild(this.messagesContainer),this.actionsContainer.appendChild(this.menusContainer),this.actionsContainer.appendChild(this.searchContainer),this.table.oncontextmenu=(e=>{e.preventDefault(),this.showContextMenu(e.pageX,e.pageY)}),this.table.ondrop=(e=>{null!==e.dataTransfer&&this.handleDataTransfer(e.dataTransfer)});let e=document.createElement("file-header");this.table.appendChild(e),this.breadCrumbs.addEventListener(o.BreadCrumbs.EVENT_PATH_CHANGE,e=>{this.path=this.breadCrumbs.path}),this.busy=Promise.resolve(),this.currentDirectory=new f.CachedProxyDirectory(new d.MemoryDirectory(null,"root"))}static get observedAttributes(){return[]}updateAttributes(e){}get rootDirectory(){return this.currentDirectory.root}set rootDirectory(e){console.log("SET ROOT",e,e.getChildren().then(e=>console.log(e))),this.currentDirectory=new f.CachedProxyDirectory(e)}get currentDirectory(){return this.cachedCurrentDirectory}set currentDirectory(e){this.cachedCurrentDirectory=e,this.cachedCurrentDirectory.addOnChangeListener(()=>{console.log("CHANGE"),this.refreshFiles()}),this.refreshFiles()}get path(){return this.currentDirectory.path.slice(1).reduce((e,t)=>(e.push(t.name),e),[])}set path(e){console.log("SET PATH",e),this.busy=this.busy.then(()=>this.logAndLoadWrapper(this.currentDirectory.root.getFile(e).then(t=>{if(console.log("NEW DIR",t),!(t instanceof f.CachedProxyDirectory))throw new s.FileNotFoundError("file must be a directory");return this.currentDirectory=t,this.breadCrumbs.path=e,this.currentDirectory.getChildren()}).then(e=>{this.setTableData(e)})))}get css(){return super.css+`\n        :host {\n          --icon-color: #5c6873;\n          --action-icon-color: #5c6873;\n          --icon-size: 22px;\n          --icon-size-small: 12px;\n          --icon-size-large: 32px;\n        }\n\n        .${m.tableIconClass} {\n          display: inline-block;\n          width: var(--icon-size);\n          height: var(--icon-size);\n          vertical-align: middle;\n          margin: 5px;\n          fill: var(--icon-color);\n        }\n\n        .${m.tableIconClass}.small {\n          width: var(--icon-size-small);\n          height: var(--icon-size-small);\n        }\n\n        .${m.tableIconClass}.large {\n          width: var(--icon-size-large);\n          height: var(--icon-size-large);\n        }\n\n        .${m.tableContainerClass} {\n          position: relative;\n          float: left;\n          width: 100%;\n          background: var(--table-background-color);\n        }\n\n        .${m.tableContainerClass}.dialog-item {\n          /*If inside dialog, make smaller*/\n          height: 300px;\n        }\n\n        .${m.tableContainerClass} .hover-image {\n          position: absolute;\n          top: calc(2 * var(--table-row-height));\n          max-height: calc(100% - 3 * var(--table-row-height));\n          z-index: 99999;\n          background-color: white;\n          border: 1px solid black;\n          box-shadow: var(--browser-shadow);\n        }\n        \n        .${m.searchContainerClass} {\n            float: right;\n        }\n        \n        .${m.menuContainerClass} {\n            float: left;\n        }\n        \n        base-dialog > * {\n            margin: 5px;\n            cursor: pointer;\n        }\n    `}render(e){super.render(e),e.appendChild(this.breadCrumbs),e.appendChild(this.actionsContainer),e.appendChild(this.tableContainer),e.appendChild(this.fileContextMenu)}loadingWrapper(e){return r(this,void 0,void 0,function*(){this.classList.add(m.activeAjaxClass);try{return yield e}finally{this.classList.remove(m.activeAjaxClass)}})}errorLoggingWrapper(e){return r(this,void 0,void 0,function*(){try{return yield e}catch(e){this.addMessage(e,!0)}})}logAndLoadWrapper(e){return this.loadingWrapper(this.errorLoggingWrapper(e))}createSearchElements(){let e=document.createElement("input");e.className=m.searchInputClass,e.placeholder="Search",e.oninput=(()=>{this.searchPending||(this.searchPending=!0,setTimeout(()=>{this.search(e.value),this.searchPending=!1},500))}),e.onkeyup=(t=>{this.searchPending||"Enter"!==t.key||this.search(e.value)});let t=document.createElement("div");return t.className=m.searchContainerClass,t.appendChild(this.searchIcon),t.appendChild(e),t}createMenus(){let e=document.createElement("div");e.className=m.menuContainerClass;let t=document.createElement("div");return t.className=m.dropdownMenuButtonClass,t.appendChild(this.dropdownMenuIcon.cloneNode(!0)),t.appendChild(this.carrotIcon.cloneNode(!0)),console.log("BUTOTN",t),t.onclick=(e=>{e.stopPropagation(),console.log("CLICK");let n=t.getBoundingClientRect(),r=document.documentElement.scrollLeft,i=document.documentElement.scrollTop;this.showContextMenu(n.left+r,n.bottom+i)}),e.appendChild(t),e}handleDataTransfer(e){return r(this,void 0,void 0,function*(){this.clearMessages();let t=[];for(let n of e.files)t.push(a.fileToArrayBuffer(n).then(e=>this.currentDirectory.addFile(e,n.name,n.type)));let n=e.getData("text/uri-list");if(n){let e=n.split("\n");if(e.length>this.maxNumMove)alert(`Cannot move more than ${this.maxNumMove} items.`);else for(let n=0;n<e.length;n++){let r=e[n];if(!r.startsWith("#")){let e=r.split("/");e.length>0&&e[e.length-1].length<255?t.push(this.currentDirectory.addFile(r,e[e.length-1])):t.push(this.currentDirectory.addFile(r,"unknown"))}}}this.logAndLoadWrapper(Promise.all(t).then(()=>{}));let i=e.getData(u.Table.dataTransferType);if(i){let e=JSON.parse(i),t=[],n=[];for(let n of e)t.push(n.name);if(n.length>this.maxNumMove)alert(`Cannot move more than ${this.maxNumMove} items.`);else if(n.length>0){let n=document.createElement("confirm-dialog");n.name="Confirm Move",n.onClose=(()=>{n.remove()});let i=document.createElement("div");i.innerText=`Are you sure you want to move ${t.join(", ")}?`,n.onConfirmed=(()=>{let t=[];for(let n of e){let e=e=>r(this,void 0,void 0,function*(){let t=yield this.currentDirectory.getFile(e.path);return yield this.currentDirectory.move(t)});t.push(e(n))}this.logAndLoadWrapper(Promise.all(t).then(()=>{})),this.fileContextMenu.visible=!1}),n.appendChild(i),n.visible=!0}}})}search(e){return r(this,void 0,void 0,function*(){this.clearMessages(),e?yield this.loadingWrapper(this.currentDirectory.search(e).then(t=>{this.setTableData(t);let n=[this.breadCrumbs.baseName].concat(this.path).join("/");this.addMessage(`${t.length} search results for "${e}" in ${n}.`)})):yield this.loadingWrapper(this.currentDirectory.getChildren().then(e=>{this.setTableData(e)}))})}fileObjectToTableRow(e){let t=document.createElement("file-row");return t.setFile(e),e.directory&&t.addDragoverAction(()=>{this.path=this.path.concat([e.name])}),t}setTableData(e){let t=[];for(let n of e){let e=this.fileObjectToTableRow(n);e.hidden=n.name.startsWith("."),n instanceof s.Directory?(e.addDragoverAction(()=>{this.path=this.path.concat([n.name])}),e.ondblclick=(e=>{this.path=this.path.concat([n.name])})):e.ondblclick=(e=>{if(null!==n.url)if(n.url.startsWith("data")){let e=document.createElement("a");e.href=n.url||"",e.setAttribute("download",n.name),e.click()}else window.open(n.url)}),t.push(e)}this.table.rows=t}showContextMenu(e,t){console.log("SHOW"),this.fileContextMenu.removeChildren();let n=[];for(let e of this.table.selectedRows)e instanceof g&&n.push(e);this.fileContextMenu.appendChildren(this.getMenuItems(n)),this.fileContextMenu.position={x:e,y:t},this.fileContextMenu.velocity={x:0,y:0},this.fileContextMenu.visible=!0,console.log("POS",t,e)}getMenuItems(e){let t=[];if(e.length>0){if(1===e.length){const n=e[0],i=n.getFile();if(null!==i){let e=document.createElement("div");if(e.innerText="Open",e.onclick=(()=>{i.directory?this.path=this.path.concat([i.name]):window.open(i.url||""),this.fileContextMenu.visible=!1}),t.push(e),i.url){let e=document.createElement("div");e.innerText="Copy Url",e.onclick=(()=>{let t=document.createElement("textarea");e.appendChild(t),t.innerText=i.url||"",t.select(),document.execCommand("copy"),e.removeChild(t)}),t.push(e)}let o=document.createElement("div");if(o.innerText="Rename",o.onclick=(()=>{this.logAndLoadWrapper((()=>r(this,void 0,void 0,function*(){let e=prompt("New Name");null!==e&&(this.fileContextMenu.visible=!1,yield i.rename(e),yield this.refreshFiles())}))())}),t.push(o),"application/javascript"===i.mimeType){let e=document.createElement("div");e.innerText="Run",e.onclick=(()=>{this.errorLoggingWrapper((()=>r(this,void 0,void 0,function*(){yield this.currentDirectory.execPath(n.path)}))())}),t.push(e)}}}let n=document.createElement("div");if(n.innerText="Delete",n.onclick=(t=>{t.preventDefault(),t.stopPropagation();let n=document.createElement("confirm-dialog");this.fileContextMenu.appendChild(n),n.onClose=(()=>{n.remove()});let i=document.createElement("div"),o=[];for(let t of e){let e=t.getFile();null!==e&&o.push(e.name)}i.innerText=`Are you sure you want to remove ${o.join(", ")}?`;let s=[];n.onConfirmed=(()=>{this.logAndLoadWrapper((()=>r(this,void 0,void 0,function*(){for(let t of e){let e=t.getFile();null!==e&&s.push(e.delete())}this.fileContextMenu.visible=!1,yield Promise.all(s),yield this.currentDirectory.clearCache()}))())}),n.appendChild(i),n.visible=!0}),t.push(n),e.length<=30){let n=document.createElement("div");n.innerText="Move",n.onclick=(t=>{t.preventDefault(),t.stopPropagation();let n=document.createElement("file-browser");n.rootDirectory=this.rootDirectory;let i=document.createElement("confirm-dialog");n.table.selectMultiple=!1,i.name="Move Files",i.classList.add(this.fileBrowserDialogClass),i.confirmationText="Select",i.onConfirmed=(()=>{this.logAndLoadWrapper((()=>r(this,void 0,void 0,function*(){let t=n.currentDirectory.path;if(1===n.table.selectedRows.length){let e=n.table.selectedData.values().next().value.name;t.push(e)}let r=[];for(let i of e){let e=yield n.currentDirectory.getFile(i.path);r.push(n.currentDirectory.move(t,e).then(()=>{}))}yield Promise.all(r),yield this.refreshFiles()}))())}),this.fileContextMenu.appendChild(i),i.addEventListener(h.Dialog.EVENT_CLOSED,()=>{this.fileContextMenu.removeChild(i)}),i.visible=!0}),t.push(n)}}let n=document.createElement("div");n.innerText="Add File",n.onclick=(e=>{e.preventDefault(),e.stopPropagation();let t=document.createElement("confirm-dialog");t.name="Add File",t.confirmationText="Add";let n=document.createElement("div"),r=document.createElement("span");r.innerText="File";let i=document.createElement("input");i.type="file",n.appendChild(r),n.appendChild(i),t.onConfirmed=(()=>{let e=[];if(null!==i.files)for(let t of i.files)e.push(a.fileToArrayBuffer(t).then(e=>this.currentDirectory.addFile(e,t.name,t.type)));this.fileContextMenu.visible=!1,this.logAndLoadWrapper(Promise.all(e).then(()=>{}))}),t.appendChild(n),this.fileContextMenu.appendChild(t),t.visible=!0}),t.push(n);let i=document.createElement("div");i.innerText="Add Directory",i.onclick=(()=>{let e=prompt("Directory Name");null!==e&&this.logAndLoadWrapper(this.currentDirectory.addDirectory(e).then(()=>{})),this.fileContextMenu.visible=!1}),t.push(i);let o=document.createElement("div"),s=document.createElement("span"),l=document.createElement("input");l.type="checkbox",l.checked=this.table.showHidden,s.innerText="Show Hidden",l.onchange=(()=>{this.table.showHidden=l.checked}),o.appendChild(s),o.appendChild(l),t.push(o);let c=document.createElement("div");return c.innerText="Visible Columns",c.onclick=(e=>{e.preventDefault(),e.stopPropagation(),this.table.visibleColumnsDialog.visible=!0}),t.push(c),t}addMessage(e,t){console.log(e);let n=document.createElement("user-message");(e instanceof Error||t)&&n.setAttribute("error",""),n.innerText=e.toString(),this.messagesContainer.appendChild(n)}clearMessages(){for(;this.messagesContainer.firstChild;)this.messagesContainer.removeChild(this.messagesContainer.firstChild)}refreshFiles(){return r(this,void 0,void 0,function*(){this.currentDirectory.clearCache();let e=yield this.currentDirectory.getChildren();console.log("CHILDREN",e,this.currentDirectory),yield this.setTableData(e)})}}m.actionsContainerClass="file-actions-container",m.tableContainerClass="file-browser-table-container",m.tableIconClass="icon",m.activeAjaxClass="ajax-active",m.searchInputClass="file-search-input",m.messageContainerClass="file-message-container",m.menuContainerClass="file-menu-container",m.searchContainerClass="file-search-container",m.stateManagerContainerClass="file-breadcrumbs-container",m.dropdownMenuButtonClass="dropdown-menu button",m.fileBrowserDialogClass="file-browser-dialog",t.FileBrowser=m;t.DialogBrowser=class extends m{constructor(e,t,n){n=n||new h.ConfirmDialog,super(e,t),this._dialog=n,this.fileContextMenu.parent=this._dialog,this.table.visibleColumnsDialog.parent=this._dialog,this._dialog.items=[this.element]}get dialog(){return this._dialog}},t.ConfigFileMixin=(e=>(class extends e{constructor(...e){super(...e),this.logAndLoadWrapper(this.getConfig().then(e=>{try{this.config=e}catch(e){console.log(`Error setting browser config: ${e}`)}}))}static get localConfigPath(){return[".config","browser"]}static get sharedConfigPath(){return["Files",".config","browser"]}static get configPaths(){return[this.sharedConfigPath,this.localConfigPath]}set config(e){let t=e.visibleColumns;if(t){let e=t.split(",");for(let t of this.table.columns)t.visible=e.includes(t.name)}let n=e.defaultSortColumn;if(n){let e=!1;n.startsWith("-")&&(e=!0,n=n.slice(1));for(let t of this.table.columns)if(t.name===n){let n;n=t.sortCompare&&e?(...e)=>-t.sortCompare(...e):t.sortCompare,this.table.defaultSortFunc=n,this.setTableData(Object.values(this.currentDirectory.data))}}}setupTable(){if(super.setupTable(),this.table)for(let e of this.table.columns){let t=e.onVisibilityChange;e.onVisibilityChange=(e=>{t(e);let n=[];for(let e of this.table.columns)e.visible&&n.push(e.name);this.addLocalConfig({visibleColumns:n.join(",")}).then().catch(e=>{console.log(`Error adding config: ${e}`)})})}}addLocalConfigFile(){return r(this,void 0,void 0,function*(){let e=this.constructor.localConfigPath.slice(),t=e.pop(),n=[];for(;e.length>0;){n.push(e.shift());try{yield this.currentDirectory.getFile(n)}catch(e){if(!(e instanceof s.FileNotFoundError))throw e;yield this.currentDirectory.addDirectory(n.slice(0,n.length-1),n[n.length-1])}}yield this.currentDirectory.addFile(n,new File([""],t,{type:"text/plain"}),t)})}addLocalConfig(e){return r(this,void 0,void 0,function*(){let t;try{let n=yield(yield this.currentDirectory.getFile(this.constructor.localConfigPath)).read();t=c.updateConfigFile(e,n)}catch(e){e instanceof s.FileNotFoundError&&(yield this.currentDirectory.waitOn(this.addLocalConfigFile.bind(this))()),t=c.updateConfigFile({})}try{yield this.currentDirectory.write(this.constructor.localConfigPath,t)}catch(e){e instanceof s.FileNotFoundError&&(yield this.currentDirectory.write(this.constructor.localConfigPath,t))}})}getConfig(){return r(this,void 0,void 0,function*(){let e={},t=this.constructor.configPaths.slice();for(;t.length>0;){let n,r=t.shift();try{let e=yield(yield this.currentDirectory.getFile(r)).read();n=c.parseConfigFile(e)}catch(e){console.log(`Could not get config file at /${r.join("/")}: ${e}`),n={}}Object.assign(e,n)}return e})}})),customElements.define("file-browser",m),customElements.define("file-row",g),customElements.define("file-header",class extends u.Header{constructor(){super()}refresh(){super.refresh();let e=document.createElement("table-data"),t=document.createElement("table-data"),n=document.createElement("table-data"),r=document.createElement("table-data"),i=document.createElement("table-data"),o=document.createElement("table-data");e.innerText="ID",t.innerText="Name",n.innerText="Size",r.innerText="Last Modified",i.innerText="Created",o.innerText="Type",this.appendChild(e),this.appendChild(t),this.appendChild(n),this.appendChild(r),this.appendChild(i),this.appendChild(o)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);class i extends r.CustomElement{constructor(){super(),this.startCharacter="|",this.delimiter=">",this.ul=document.createElement("ul")}updateAttributes(e){}get css(){return super.css+"\n      :host {\n        --breadcrumb-color: #5d91e5;\n        --delimiter-color: #5c6873;\n      }\n\n      ul {\n        margin: 0;\n        padding: 0;\n        list-style: none;\n        height: 26px;\n      }\n\n      /* Display list items side by side */\n      li {\n        display: inline;\n        font-size: 18px;\n      }\n\n      /* Add a slash symbol (/) before/behind each list item */\n      li {\n        color: var(--delimiter-color);\n        margin-left: 10px;\n        margin-right: 10px;\n      }\n\n      /* Add a color to all links inside the list */\n      a {\n        color: var(--breadcrumb-color);\n        text-decoration: none;\n        font-weight: bold;\n      }\n\n      /* Add a color on mouse-over */\n      a:hover {\n        color: #01447e;\n        text-decoration: underline;\n      }\n    "}get crumbs(){return null===this.shadowRoot?[]:this.shadowRoot.querySelectorAll("a")}get path(){let e=this.crumbs,t=[];for(let n of e)t.push(n.innerText);return t}set path(e){for(;this.ul.firstChild;)this.ul.removeChild(this.ul.firstChild);for(let t=0;t<e.length;t++){let n=0==t?this.startCharacter:this.delimiter;this.ul.appendChild(this.buildDelimiter(n));let r=e.slice(0,t+1);this.ul.appendChild(this.buildCrumb(r))}}render(e){super.render(e),e.appendChild(this.ul)}buildCrumb(e){let t=document.createElement("li"),n=document.createElement("a");return n.href="#",n.innerText=e[e.length-1],n.onclick=(t=>{t.preventDefault(),this.path=e,this.dispatchEvent(new Event(i.EVENT_PATH_CHANGE))}),t.appendChild(n),t}buildDelimiter(e){let t=document.createElement("li");return t.innerText=e,t}}i.EVENT_PATH_CHANGE="pathchange",t.BreadCrumbs=i,customElements.define("bread-crumbs",i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dropdownMenuIcon='<svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="220" height="220" viewBox="0 0 440 440">  <path d="M170 423 c0 -38 -15 -46 -49 -29 -31 17 -32 16 -62 -13 -29 -30 -30\n-31 -13 -62 17 -34 9 -49 -28 -49 -26 0 -26 -100 0 -100 37 0 45 -15 28 -49\n-17 -31 -16 -32 13 -62 30 -29 31 -30 62 -13 34 17 49 9 49 -28 0 -26 100 -26\n100 0 0 37 15 45 49 28 31 -17 32 -16 62 13 29 30 30 31 13 62 -17 34 -9 49\n29 49 25 0 25 100 0 100 -38 0 -46 15 -29 49 17 31 16 32 -13 62 -30 29 -31\n30 -62 13 -34 -17 -49 -9 -49 29 0 25 -100 25 -100 0z m105 -148 c50 -49 15\n-135 -55 -135 -41 0 -80 39 -80 80 0 19 9 40 25 55 15 16 36 25 55 25 19 0 40\n-9 55 -25z"/>  <path d="M182 258 c-15 -15 -15 -61 0 -76 15 -15 61 -15 76 0 15 15 15 61 0\n76 -7 7 -24 12 -38 12 -14 0 -31 -5 -38 -12z"/></svg>',t.carrotIcon='<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="24pt" height="16pt" viewBox="0 0 24 16">  <path d="M 12,16 0,7 5.25,0.25 12,5.5 18,0.25 24,7 Z"/></svg>',t.searchIcon='<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="220" height="220" viewBox="0 0 440 440">  <path d="m 180,310 -40,56 C 116,396 86,422 74,426 30,438 2,410 14,366 18,354 44,324 74,300 l 56,-40 C 81.263674,188.193 104,100 160,50 220,-3 326,-4 380,60 c 53,62 59,175 1,229 C 320,346 225,354 180,310 Z M 340,100 C 247,-3 100,140 190,250 282,347 435,206 340,100 Z"/></svg>',t.folderIcon='<svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="220" height="220" viewBox="0 0 440 440">  <path d="M0 220 l0 190 220 0 220 0 0 -166 0 -165 -124 0 -125 0 -16 -28 c-15 -26 -20 -27 -96 -27 l-79 0 0 -190z"/></svg>',t.documentIcon='<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="220" height="220" viewBox="0 0 440 440">  <path d="M 390,220 V 440 H 215 40 V 278 116 L 97,58 154,0 H 272 390 Z M 124,130 H 80 V 265 400 H 215 350 V 220 41 H 170 v 90 0 z"/></svg>'},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);function o(e){let t={};try{let n=i.parseTextArrayBuffer(e).split("\n");for(let e of n){let n=e.split("=");2===n.length&&(t[n[0].trim()]=n[1].trim())}}catch(e){console.log(`Error parsing config file: ${e}`)}return t}t.parseConfigFile=o,t.updateConfigFile=function(e,t){return r(this,void 0,void 0,function*(){let n;n=t?o(t):{},Object.assign(n,e);let r="";for(let e in n)r+=`${e}=${n[e]}\n`;return i.stringToArrayBuffer(r)})}},function(e,t,n){"use strict";n.r(t);var r=n(6),i=n(2),o=n(5);function s(e){return class extends e{constructor(...e){super(...e),this.dragOverActions=[],this.dragOverDelay=2e3,this.timeOuts=[],this.addEventListener("dragover",this.handleDragOver.bind(this)),this.addEventListener("dragenter",this.handleDragEnter.bind(this)),this.addEventListener("dragleave",this.handleDragLeave.bind(this)),this.addEventListener("drop",this.handleDrop.bind(this))}static get dragOverClass(){return"dragover"}static get pendingActionClass(){return"pending-action"}get isOver(){return this.classList.contains(this.constructor.dragOverClass)}addDragoverAction(e){this.dragOverActions.push(e)}handleDragOver(e){e.preventDefault()}handleDragEnter(e){e.preventDefault(),this.classList.add(this.constructor.dragOverClass),this.setTimeouts()}handleDragLeave(e){e.preventDefault(),this.classList.remove(this.constructor.dragOverClass),this.clearTimeOuts()}handleDrop(e){e.preventDefault(),this.classList.remove(this.constructor.dragOverClass),this.clearTimeOuts()}setTimeouts(){if(this.dragOverActions.length>0){for(let e of this.dragOverActions){let t=window.setTimeout(()=>{e()},this.dragOverDelay);this.timeOuts.push(t)}this.classList.add(this.constructor.pendingActionClass)}}clearTimeOuts(){this.classList.remove(this.constructor.pendingActionClass);for(let e of this.timeOuts)window.clearTimeout(e);this.timeOuts=[]}}}n.d(t,"Header",function(){return h}),n.d(t,"Row",function(){return u}),n.d(t,"Data",function(){return d}),n.d(t,"Table",function(){return f});customElements.define("table-body",class extends o.b{get template(){return"\n      <slot></slot>\n    "}get parentHeightDifference(){return null===this.parentElement?0:this.parentElement.getBoundingClientRect().height-this.getBoundingClientRect().height}get position(){return super.position}set position(e){e.x=0,e.y=Math.min(0,Math.max(this.parentHeightDifference,e.y||0)),super.position=e}});class a extends i.CustomElement{constructor(){super(),this.view=document.createElement("div"),this.pane=document.createElement("table-body");let e=document.createElement("slot");this.pane.appendChild(e),this.view.appendChild(this.pane)}updateAttributes(e){}render(e){super.render(e),this.view.style.position="relative",this.view.style.overflowY="hidden",this.view.style.height="inherit",this.view.style.width="100%",this.pane.style.width="100%",e.appendChild(this.view)}}class l extends i.CustomElement{get table(){let e=this.parentElement;for(;e;){if(e instanceof f)return e;e=e.parentElement}return null}updateAttributes(e){}}class c extends l{constructor(){super(),this.hiddenClass="hidden"}get css(){return"\n        :host {\n            --selected-item-color: #5d91e5;\n            --focus-item-color: #c0d5e8;\n\n            display: flex;\n            width: 100%;\n            height: var(--table-row-height, 30px);\n            line-height: var(--table-row-height, 30px);\n        }\n     "}get template(){return"\n      <slot></slot>\n    "}get hidden(){return this.classList.contains(this.hiddenClass)}set hidden(e){e?this.classList.add(this.hiddenClass):this.classList.remove(this.hiddenClass)}get allColumns(){return Array.from(this.children).filter(e=>e instanceof d)}getColumn(e){return this.allColumns[e]||null}}class h extends c{constructor(){super(),this.onclick=(e=>{let t=e.target;if(t instanceof d){let e=this.table,n=t.column;null!==e&&null!==n&&e.sortColumn(n)}})}get css(){return super.css+"\n        :host {\n            --table-header-text-color: white;\n            --table-header-color: #5c6873;\n            \n            color: var(--table-header-text-color);\n            background: var(--table-header-color);\n            text-transform: uppercase;\n        }\n        \n        :host > * {\n          cursor: pointer;\n        }\n        \n        a {\n            text-decoration: none;\n            color: var(--table-header-text-color);\n            font-weight: bold;\n        }\n     "}connectedCallback(){super.connectedCallback(),this.setAttribute("slot",f.HEADER_SLOT_NAME)}}class u extends(function(e){return class extends e{constructor(...e){super(...e),this.addEventListener("dragstart",this.handleDragStart.bind(this)),this.addEventListener("dragend",this.handleDragEnd.bind(this))}static get draggingClass(){return"dragging"}connectedCallback(){super.connectedCallback(),this.draggable=!0}handleDragStart(e){this.classList.add(this.constructor.draggingClass)}handleDragEnd(e){this.classList.remove(this.constructor.draggingClass)}}}(s(c))){constructor(){super(),this.selected=!1,this.hidden=!1,this.onclick=(e=>{let t=this.table;if(null!==t){let n,r;e.shiftKey?(n=!0,r=!0):e.ctrlKey||e.metaKey?(n=!1,r=!0):(n=!1,r=!1),t.toggleRowSelection(this,r,n)}})}get css(){return super.css+`\n        :host(:hover) {\n            background: var(--focus-item-color);\n            cursor: pointer;\n        }\n        \n        :host(.${u.SELECTED_CLASS}){\n          background-color: var(--selected-item-color);\n          color: #fff;\n        }\n        \n        :host(.dragover) {\n            background: var(--focus-item-color);\n        }\n        \n        a.button {\n          -webkit-appearance: button;\n          -moz-appearance: button;\n          appearance: button;\n        \n          text-decoration: none;\n          color: initial;\n        }\n    `}get selected(){return this.classList.contains(u.SELECTED_CLASS)}get data(){let e=[];for(let t of this.allColumns)e.push(t.data);return e}set selected(e){e?(this.classList.add(u.SELECTED_CLASS),this.dispatchEvent(new Event("selected"))):(this.classList.remove(u.SELECTED_CLASS),this.dispatchEvent(new Event("deselected")))}toggleSelected(){this.selected=!this.selected}handleDragStart(e){super.handleDragStart(e),e.dataTransfer&&(e.dataTransfer.setData(u.DATA_TRANSFER_TYPE,JSON.stringify(this.data)),e.dataTransfer.dropEffect="move")}}u.DATA_TRANSFER_TYPE="text/table-rows",u.SELECTED_CLASS="selected";class d extends l{constructor(){super(),this.ascendingSortClass="asc",this.descendingSortClass="des"}static get observedAttributes(){return["width"]}get css(){return`\n        :host {\n            flex: 1;\n            padding: 0;\n            text-align: start;\n            font-size: calc(4px + .75vw);\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n        \n        :host::after {\n            float: right;\n            margin-right: 10px;\n        }\n\n        :host(.${this.ascendingSortClass})::after {\n           content: "\\25BC";\n        }\n\n        :host(.${this.descendingSortClass})::after {\n            content: "\\25B2";\n        }\n\n    `}get template(){return"\n      <slot></slot>\n    "}get data(){return this.innerText}set data(e){this.innerText=e.toString()}get width(){let e=this.style.flex;return null===e?null:Number.parseInt(e)}set width(e){this.style.flex=null===e?null:e.toString()}get column(){let e=this.parentElement;return e instanceof c?e.allColumns.indexOf(this):null}get sortOrder(){return this.classList.contains(this.ascendingSortClass)?1:this.classList.contains(this.descendingSortClass)?-1:0}updateAttributes(e){let t=null;null!==e.width&&(t=Number.parseInt(e.width)),this.width=t}compare(e){return this.data.localeCompare(e.data)}toggleSortOrder(){let e=this.ascendingSortClass;this.classList.contains(this.ascendingSortClass)?e=this.descendingSortClass:this.classList.contains(this.descendingSortClass)&&(e=null),this.classList.remove(this.ascendingSortClass,this.descendingSortClass),null!==e&&this.classList.add(e)}}class f extends(s(a)){constructor(){super(),this.headerContainerClass="header",this.showHiddenClass="show-hidden",this.sortStack=[],this._selectMultiple=!1,this.columnsDialog=new r.Dialog,this.columnsDialog.name="Columns",this.onclick=(e=>{let t=e.target;if(t instanceof u&&!this.selectMultiple)for(let e of this.selectedRows)e!==t&&(e.selected=!1)})}static get observedAttributes(){return["select-multiple"]}get template(){return null}get css(){return`      \n        :host {\n            --table-row-height: 30px;\n            --table-background-color: white;\n          \n            position: relative;\n            padding: 0;\n            width: 100%;\n            height: 400px;\n            background-color: var(--table-background-color);\n            border-spacing: 0;\n            box-shadow: none;\n            color: var(--body-text-color);\n        }\n        \n        a {\n            text-decoration: none;\n            color: var(--selected-item-color);\n            font-weight: bold;\n        }\n        \n        .${this.headerContainerClass} {\n            width: 100%;\n        }\n     `}get selectedData(){let e=new Set;for(let t of this.selectedRows)e.add(t.data);return e}get selectedRows(){return Array.from(this.querySelectorAll(`.${u.SELECTED_CLASS}`))}set selectedRows(e){let t=new Set(this.selectedRows),n=new Set(e),r=[...n].filter(e=>!t.has(e)),i=[...t].filter(e=>!n.has(e));for(let e of i)e.selected=!1;for(let e of r)e.selected=!0;let o=new Event(f.EVENT_SELECTION_CHANGED);this.dispatchEvent(o)}get rows(){return this.flatChildren(u)}set rows(e){this.removeChildren(u),this.appendChildren(e)}get showHidden(){return this.classList.contains(this.showHiddenClass)}get visibleColumnsDialog(){return this.columnsDialog}get selectMultiple(){return this._selectMultiple||!1}set selectMultiple(e){this._selectMultiple=e;for(let e of this.flatChildren(u))e.selected=!1}set showHidden(e){e?this.classList.add(this.showHiddenClass):this.classList.remove(this.showHiddenClass)}get mainHeader(){return this.querySelector("table-header")}updateAttributes(e){let t=e["select-multiple"];this.selectMultiple=null!==t}render(e){let t=document.createElement("div");t.className=this.headerContainerClass;let n=document.createElement("slot");n.name=f.HEADER_SLOT_NAME,t.appendChild(n),e.appendChild(t),super.render(e)}sortColumn(e){let t=this.mainHeader;if(t){let n=t.getColumn(e);if(n){if(n.toggleSortOrder(),0===n.sortOrder){let e=this.sortStack.indexOf(n);e&&this.sortStack.splice(e,1)}else this.sortStack.push(n);this.sort()}}}sort(){let e=document.createDocumentFragment(),t=this.rows,n=[];for(let e of this.sortStack){let t=e.sortOrder,r=e.column;0!==t&&null!==r&&n.unshift({columnNumber:r,sortOrder:t})}t=t.sort((e,t)=>{for(let r of n){let n=e.getColumn(r.columnNumber),i=t.getColumn(r.columnNumber);if(null===n||null===i)return 0;n.compare(i);let o=r.sortOrder*n.compare(i);if(0!==o)return o}return 0});for(let n of t)e.appendChild(n);this.appendChild(e)}toggleRowSelection(e,t,n){this.selectMultiple||(t=!1,n=!1);let r,i=new Set(this.selectedRows);if(r=t?new Set(i):new Set,!n&&i.has(e)?r.delete(e):null!==e&&r.add(e),t&&n&&i.size>0){let t=this.rows,n=t.indexOf(e),o=t.indexOf(e);for(let e of i){let r=t.indexOf(e);Math.abs(r-o)<Math.abs(n-o)&&(n=r)}let s=Math.min(n,o)+1,a=Math.max(n,o),l=t.slice(s,a);for(let e of l)!this.showHidden&&e.hidden||r.add(e)}this.selectedRows=Array.from(r)}}f.HEADER_SLOT_NAME="header",f.EVENT_SELECTION_CHANGED="selectionchanged",customElements.define("table-header",h),customElements.define("table-row",u),customElements.define("table-data",d),customElements.define("selectable-table",f)}]);
//# sourceMappingURL=bundle.1.3.2.js.map